### Faster R CNN 
#### 개념적 요소
- CNN Backbone에서 특징 추출
- RPN(Region Proposal Network, 영역제안네트워크)을 특징맵(feature map) 위에서 RoI를 생성
- 추출된 관심영역을 풀링(RoI Pooling)을 통해 고정된 크기의 특징 맵 생성
- 이를 분류기와 회귀기에 입력해 객체를 검출함
#### Faster R CNN의 특징
- Faster R CNN은 영역제안 네트워크에서 관심영역을 추출하는 과정과 특징맵 생성을 동일한 합성곱 연산을 통해 수행하므로
- 모델의 매개변수를 공유할 수 있어서 연산 효율이 높음
  
### 개념 구성
#### 영역제안네트워크(RPN) - 아주 작은 CNN으로 파악
- 입력된 이미지에서 객젝의 관심영역(RoI)를 추출하는 네트워크
- RPN에서 입력 받은 특징 맵을 일정한 크기의 윈도우 영역을 이동해 가면서 중간층[RPN 내부의 작은 합성곱 레이어(hidden layer), 3x3 convelution (shared)]에 전달.
- 슬라이드 윈도우는 중간층(앵커 판단을 위한 특징 추출기)에서 합성곱 연산을 수행하며 256차원 또는 512차원의 벡터를 생성
- 생성된 벡터는 다시 물체를 판별하는 박스 분류계층(cls layer)과 후보 영역의 좌표를 생성하는 박스 회귀계층(reg layer)로 구성
- 슬라이딩 윈도우는 일정한 크기의 Grid로 분할하며 이미지의 크기를 그리드 크기로 나눔.
- ex 515 X 512 크기 이미지를 16 X 16 그리드로 변환하면 32(512/16) x 32가 되어 1,024(32 x 32)개 슬라이딩 윈도우가 됨
- 이렇게 생성된 슬라이딩 윈도우의 중심을 기준으로 여러개의 앵커박스를 적용함

#### 앵커박스
- Anchor Box는 객체의 위치와 크기를 예측하기 위해 사용되는 사각형 영역으로 슬라이딩 윈도우와 함께 9개로 사용됨.
- 작은 크기(128), 중간크기(256), 큰크기(512)에 각각 정사각형(1:1), 가로형(1:2), 세로형(2:1)이 있음.
- 이 Anchor Box 내 객체의 존재 여부와 객체의 크기 및 위치를 예측

#### 박스분류계층(cls layer)
- 박스 분류계층은 9개의 앵커박스에 객체가 존재 유/무 계산, (object / background)
- 하나의 슬라이딩 윈도우는 9개의 앵커박스를 가지므로 박스 cls layer는 18개 생성됨
- 슬라이딩 윈도우가 H x W x C의 크기를 갖는다면, 1 x 1 x 18 합성곱 연산을 적용해 H x W x 18 크기의 특징 맵을 생성
- 1 x 1 크기의 합성곱 연산을 적용하면 입력 이미지 크기와 상관없이 동작할 수 있음
- 한 번의 합성곱 연산으로 H x W 개의 앵커 박스에 대한 예측을 한 번에 수행할 수 있음

#### 박스분류회귀(reg layer)
- 9개의 앵커박스로 객체의 크기 및 위치를 예측했지만 고정적인 비율과 그리드를 통해 특징 맵으로 변환했으므로 예측값이 정확하지 않음.
- 그러므로 R-CNN처럼 박스 회귀를 통해 경계 상자의 크기와 위치를 1 x 1 합성곱을 통해 경계 상자의 크기와 위치를 조정해야 함.
- 앵커 박스 9개, 각 박스 위치 보정 값 4[위치(x, y), 크기(w, h)]개 = 9 x 4 = 36개의 클래스가 존재
- 출력된 위치와 크기를 조정하기 위해 네개의 조정값으로 회귀를 진행함

#### 관심영역선별
 - 실제값 박스와 앵커박스 교차영역 비율(Intersection over Union, IoU)이 0.7 이상 - 관심영역

#### 모델학습과정
 - 2단계로 객체 탐지, YOLO와 차이
 - 1단계 영역제안네트워크(RPN)를 사용해 입력 이미지에서 객체가 있을 가능성이 있는 관심영역 추출
 - 2단계: 객체탐지 네트워크를 통해 후보 영역들에 대한 객체를 탐지


### Backbone으로 VGG16, EffientNet을 분석함

### YOLO 파악함